<div class="row">
    <div class="col-sm-3">

        <img class="img-rounded" ng-if="user.image" ng-src="{{user.image}}" />
        <i class="top15 glyphicon glyphicon-user text-muted fa-5x" ng-if="!user.image"></i>

        <h3><a ng-href="#/admin/users/{{user._id}}">{{user.lastname}} {{user.firstname}}</a></h3>

        <p><a href="mailto:{{user.email}}">{{user.email}}</a></p>

        <p><span translate>Department:</span> {{user.department.name}}</p>
        <p ng-if="user.roles.account.arrival"><span translate>Arrival date:</span> {{user.roles.account.arrival|date}}</p>
    </div>



    <div class="col-xs-12 col-sm-9">

        <div class="row panel panel-primary">

            <h2 class="col-sm-12"><a href="#/admin/rights/{{beneficiary.right._id}}">{{beneficiary.right.name}}</a></h2>

            <div class="col-sm-8">
                <p><span translate>Type:</span> {{beneficiary.right.type.name}}</p>
                <p><span translate>Default quantity on start renewal:</span> {{beneficiary.right.quantity | number}} {{beneficiary.right.quantity_dispUnit}}</p>
            </div>

            <div class="col-sm-4">
                <p ng-if="beneficiary.right.require_approval"><span translate>Require approval</span></p>
                <p ng-if="!beneficiary.right.require_approval"><span translate>Do not require approval</span></p>
                <p>{{beneficiary.right.rules.length}} rules</p>
            </div>
        </div>


        <div class="row panel panel-default" ng-repeat="renewal in beneficiary.renewals">

            <div class="panel-heading"><i class="glyphicon glyphicon-retweet"></i> &nbsp; From <strong>{{renewal.start|date}}</strong> to <strong>{{renewal.finish|date}}</strong></div>

            <div class="panel-body">
                <dl class="dl-horizontal col-md-8">
                    <dt translate>Initial:</dt>    <dd>{{renewal.initial_quantity}} {{renewal.initial_quantity_dispUnit}}</dd>
                    <dt translate>Consumed:</dt>   <dd>{{renewal.consumed_quantity}} {{renewal.consumed_quantity_dispUnit}}</dd>
                    <dt translate>Available:</dt>  <dd>{{renewal.available_quantity}} {{renewal.available_quantity_dispUnit}}</dd>
                </dl>

                <div class="col-md-4">
                    <button class="btn btn-primary" ng-click="addAdjustment(renewal);"><i class="fa fa-plus"></i> Add a quantity adjustment</button>
                </div>
            </div>

            <table class="table" ng-if="renewal.adjustments.length>0">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Author</th>
                        <th>Quantity</th>
                        <th>Comment</th>
                    </tr>
                </thead>

                <tbody>
                    <tr ng-repeat="adjustment in renewal.adjustments">
                        <td>{{adjustment.timeCreated|date}}</td>
                        <td>{{adjustment.userCreated.name}}</td>
                        <td><span ng-if="adjustment.quantity>0">+</span>{{adjustment.quantity}} {{renewal.initial_quantity_dispUnit}}</td>
                        <td>{{adjustment.comment}}</td>
                    </tr>
                </tbody>
            </table>


        </div>

    </div>
</div>
